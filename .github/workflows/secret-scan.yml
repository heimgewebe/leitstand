name: secret-hygiene
on: [push, pull_request]

jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Fail on obvious secret files
        run: |
          forbidden=$(git ls-files | grep -E '\.(env|pem|key)$|id_rsa|kubeconfig' || true)
          if [ -n "$forbidden" ]; then
            echo "Forbidden files detected:"
            echo "$forbidden"
            exit 1
          fi
